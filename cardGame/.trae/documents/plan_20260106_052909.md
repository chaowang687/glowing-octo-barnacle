# 完善存档功能并确保在退出游戏时数据能更新到主界面

## 问题分析
当前存档系统存在以下问题：
1. 没有在退出游戏时自动保存数据的逻辑
2. 背包数据与GameDataManager没有完全同步
3. 主界面可能无法正确显示最新的存档数据
4. 存档接口不统一，有多个保存方法

## 完善方案

### 1. 确保在退出游戏时保存数据
- 在GameManager或GameDataManager中添加Application.quitting事件监听
- 确保在应用退出时调用SaveGameData方法保存所有数据

### 2. 确保背包数据与GameDataManager同步
- 在InventoryManager中添加与GameDataManager的数据同步机制
- 确保背包数据在GameDataManager中也有备份
- 在保存游戏数据时同时保存背包数据

### 3. 确保主界面能正确显示存档数据
- 确保主界面能从GameDataManager获取最新的存档数据
- 在主界面加载时调用LoadGameData方法
- 在从游戏返回主界面时更新存档数据显示

### 4. 统一存档接口
- 整理和统一所有存档方法
- 确保所有数据都通过GameDataManager进行统一管理
- 简化存档和加载的流程

## 具体实现步骤

1. **修改GameDataManager.cs**
   - 添加Application.quitting事件监听，确保在退出游戏时保存数据
   - 添加背包数据的保存和加载方法
   - 确保所有数据都通过GameDataManager进行统一管理

2. **修改InventoryManager.cs**
   - 添加与GameDataManager的数据同步机制
   - 确保背包数据在GameDataManager中也有备份
   - 在保存和加载时与GameDataManager同步

3. **修改主界面相关代码**
   - 确保主界面能从GameDataManager获取最新的存档数据
   - 在主界面加载时调用LoadGameData方法
   - 在从游戏返回主界面时更新存档数据显示

4. **统一存档接口**
   - 整理和统一所有存档方法
   - 确保所有数据都通过GameDataManager进行统一管理
   - 简化存档和加载的流程

5. **测试和调试**
   - 测试在退出游戏时数据是否能正确保存
   - 测试背包数据是否与GameDataManager同步
   - 测试主界面是否能正确显示最新的存档数据

## 预期效果
- 在退出游戏时自动保存所有数据
- 背包数据与GameDataManager完全同步
- 主界面能正确显示最新的存档数据
- 存档接口统一，使用简单
- 数据在游戏和主界面之间能正确传递